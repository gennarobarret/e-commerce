{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, ChangeDetectionStrategy } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet LoginComponent = class LoginComponent {\n  constructor(formBuilder, authService, router, toastService) {\n    this.formBuilder = formBuilder;\n    this.authService = authService;\n    this.router = router;\n    this.toastService = toastService;\n    this.submitted = false;\n    this.loginForm = this.formBuilder.group({\n      userName: ['', [Validators.required]],\n      password: ['', Validators.required]\n    });\n  }\n  get f() {\n    return this.loginForm.controls;\n  }\n  ngOnInit() {\n    if (this.authService.getToken()) {\n      this.router.navigate(['']);\n    }\n  }\n  login() {\n    this.submitted = true;\n    if (this.loginForm.valid) {\n      this.authService.login_admin(this.loginForm.value).subscribe(response => {}, error => {\n        let errorMessage = 'Invalid credentials';\n        if (error.error && error.error.message) {\n          errorMessage = error.error.message;\n        }\n        this.toastService.showToast('error', errorMessage);\n      });\n      this.handleSuccessfulLogin();\n    } else {\n      this.toastService.showToast('error', 'Missing form data');\n    }\n  }\n  handleSuccessfulLogin() {\n    this.authService.loginSuccessObservable.subscribe(success => {\n      if (success) {\n        this.toastService.showToast('success', 'Welcome ' + this.loginForm.value.userName);\n      }\n    });\n  }\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})], LoginComponent);\nexport { LoginComponent };\n// import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n//  import { Router } from '@angular/router';\n// import { AuthService } from 'src/app/core/auth/auth.service';\n// import { ToastService } from 'src/app/shared/services/toast.service';\n// import { FormGroup, FormBuilder, Validators } from '@angular/forms';\n// import { catchError, finalize } from 'rxjs/operators';\n// import { throwError } from 'rxjs';\n// interface ApiResponse {\n//   data?: any;\n//   token?: string;\n// }\n// @Component({\n//   selector: 'app-login',\n//   templateUrl: './login.component.html',\n//   styleUrls: ['./login.component.css'],\n//   changeDetection: ChangeDetectionStrategy.OnPush\n// })\n// export class LoginComponent implements OnInit {\n//   public user: any = {};\n//   public token: any = '';\n//   public loginForm: FormGroup;\n//   constructor(\n//     private formBuilder: FormBuilder,\n//     private _authService: AuthService,\n//     private _router: Router,\n//     private _toastService: ToastService\n//   ) {\n//     this.token = this._authService.getToken();\n//     this.loginForm = this.formBuilder.group({\n//       userName: ['', [Validators.required, Validators.userName]],\n//       password: ['', Validators.required],\n//     });\n//   }\n//   ngOnInit(): void {\n//     if (this.token) {\n//       this._router.navigate(['']);\n//     }\n//   }\n//   login() {\n//     if (this.loginForm.valid) {\n//       const { userName, password } = this.loginForm.value;\n//       const data = { userName, password };\n//       this._authService.login_admin(data).subscribe(\n//         (response: ApiResponse) => {\n//           if (!response.data) {\n//             this._toastService.showToast('error', 'There was an error during login');\n//           } else {\n//             this.handleSuccessfulLogin(response);\n//           }\n//         },\n//         (error) => {\n//           this._toastService.showToast('error', 'There was an error during login');\n//           console.error(error);\n//         }\n//       );\n//     } else {\n//       this._toastService.showToast('error', 'Invalid form data');\n//     }\n//   }\n//   private handleSuccessfulLogin(response: ApiResponse) {\n//     this.user = response.data;\n//     localStorage.setItem('token', response.token || '');\n//     this._router.navigate(['/']);\n//   }\n// }\n// import { Component } from '@angular/core';\n// @Component({\n//   selector: 'app-login',\n//   templateUrl: './login.component.html',\n//   styleUrls: ['./login.component.css']\n// })\n// export class LoginComponent {\n// }","map":{"version":3,"names":["Component","ChangeDetectionStrategy","Validators","LoginComponent","constructor","formBuilder","authService","router","toastService","submitted","loginForm","group","userName","required","password","f","controls","ngOnInit","getToken","navigate","login","valid","login_admin","value","subscribe","response","error","errorMessage","message","showToast","handleSuccessfulLogin","loginSuccessObservable","success","__decorate","selector","templateUrl","styleUrls","changeDetection","OnPush"],"sources":["C:\\Users\\Javier\\Documents\\proyectos\\e-commerce\\admin\\src\\app\\modules\\auth\\login\\login.component.ts"],"sourcesContent":["import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\nimport { HttpErrorResponse } from '@angular/common/http';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { AuthService } from 'src/app/core/auth/auth.service';\nimport { ToastService } from 'src/app/shared/services/toast.service';\nimport { LoginCredentials } from 'src/app/core/model';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class LoginComponent implements OnInit {\n  public loginForm: FormGroup;\n  submitted = false;\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private authService: AuthService,\n    private router: Router,\n    private toastService: ToastService\n  ) {\n    this.loginForm = this.formBuilder.group({\n      userName: ['', [Validators.required]],\n      password: ['', Validators.required],\n    });\n    \n  }\n\n  get f() {\n    return this.loginForm.controls;\n  }\n  \n  ngOnInit(): void {\n    if (this.authService.getToken()) {\n      this.router.navigate(['']);\n    }\n  }\n\n  login() {\n    this.submitted = true;\n    if (this.loginForm.valid) {\n      this.authService\n        .login_admin(this.loginForm.value as LoginCredentials)\n        .subscribe(\n          (response) => {\n          },\n          (error: HttpErrorResponse) => {\n            let errorMessage = 'Invalid credentials';\n            if (error.error && error.error.message) {\n              errorMessage = error.error.message;\n            }\n            this.toastService.showToast('error', errorMessage);\n          }\n        );\n        this.handleSuccessfulLogin();\n  \n    } else {\n      this.toastService.showToast('error', 'Missing form data');\n    }\n  }\n\n  private handleSuccessfulLogin(){\n    this.authService.loginSuccessObservable.subscribe((success: boolean) => {\n      if (success) {\n        this.toastService.showToast(\n          'success',\n          'Welcome ' + this.loginForm.value.userName\n        );\n      }\n    });\n  }\n\n\n\n}\n\n\n\n\n// import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\n//  import { Router } from '@angular/router';\n// import { AuthService } from 'src/app/core/auth/auth.service';\n// import { ToastService } from 'src/app/shared/services/toast.service';\n// import { FormGroup, FormBuilder, Validators } from '@angular/forms';\n// import { catchError, finalize } from 'rxjs/operators';\n// import { throwError } from 'rxjs';\n\n// interface ApiResponse {\n//   data?: any;\n//   token?: string;\n// }\n\n// @Component({\n//   selector: 'app-login',\n//   templateUrl: './login.component.html',\n//   styleUrls: ['./login.component.css'],\n//   changeDetection: ChangeDetectionStrategy.OnPush\n// })\n// export class LoginComponent implements OnInit {\n//   public user: any = {};\n//   public token: any = '';\n//   public loginForm: FormGroup;\n\n//   constructor(\n//     private formBuilder: FormBuilder,\n//     private _authService: AuthService,\n//     private _router: Router,\n//     private _toastService: ToastService\n//   ) {\n//     this.token = this._authService.getToken();\n//     this.loginForm = this.formBuilder.group({\n//       userName: ['', [Validators.required, Validators.userName]],\n//       password: ['', Validators.required],\n//     });\n//   }\n\n//   ngOnInit(): void {\n//     if (this.token) {\n//       this._router.navigate(['']);\n//     }\n//   }\n\n//   login() {\n//     if (this.loginForm.valid) {\n//       const { userName, password } = this.loginForm.value;\n//       const data = { userName, password };\n//       this._authService.login_admin(data).subscribe(\n//         (response: ApiResponse) => {\n//           if (!response.data) {\n//             this._toastService.showToast('error', 'There was an error during login');\n//           } else {\n//             this.handleSuccessfulLogin(response);\n//           }\n//         },\n//         (error) => {\n//           this._toastService.showToast('error', 'There was an error during login');\n//           console.error(error);\n//         }\n//       );\n//     } else {\n//       this._toastService.showToast('error', 'Invalid form data');\n//     }\n//   }\n\n//   private handleSuccessfulLogin(response: ApiResponse) {\n//     this.user = response.data;\n//     localStorage.setItem('token', response.token || '');\n//     this._router.navigate(['/']);\n//   }\n\n// }\n\n// import { Component } from '@angular/core';\n\n// @Component({\n//   selector: 'app-login',\n//   templateUrl: './login.component.html',\n//   styleUrls: ['./login.component.css']\n// })\n// export class LoginComponent {\n\n// }\n"],"mappings":";AAAA,SAASA,SAAS,EAAUC,uBAAuB,QAAQ,eAAe;AAE1E,SAAiCC,UAAU,QAAQ,gBAAgB;AAYnE,IAAaC,cAAc,GAA3B,MAAaA,cAAc;EAIzBC,YACUC,WAAwB,EACxBC,WAAwB,EACxBC,MAAc,EACdC,YAA0B;IAH1B,KAAAH,WAAW,GAAXA,WAAW;IACX,KAAAC,WAAW,GAAXA,WAAW;IACX,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,YAAY,GAAZA,YAAY;IANtB,KAAAC,SAAS,GAAG,KAAK;IAQf,IAAI,CAACC,SAAS,GAAG,IAAI,CAACL,WAAW,CAACM,KAAK,CAAC;MACtCC,QAAQ,EAAE,CAAC,EAAE,EAAE,CAACV,UAAU,CAACW,QAAQ,CAAC,CAAC;MACrCC,QAAQ,EAAE,CAAC,EAAE,EAAEZ,UAAU,CAACW,QAAQ;KACnC,CAAC;EAEJ;EAEA,IAAIE,CAACA,CAAA;IACH,OAAO,IAAI,CAACL,SAAS,CAACM,QAAQ;EAChC;EAEAC,QAAQA,CAAA;IACN,IAAI,IAAI,CAACX,WAAW,CAACY,QAAQ,EAAE,EAAE;MAC/B,IAAI,CAACX,MAAM,CAACY,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;;EAE9B;EAEAC,KAAKA,CAAA;IACH,IAAI,CAACX,SAAS,GAAG,IAAI;IACrB,IAAI,IAAI,CAACC,SAAS,CAACW,KAAK,EAAE;MACxB,IAAI,CAACf,WAAW,CACbgB,WAAW,CAAC,IAAI,CAACZ,SAAS,CAACa,KAAyB,CAAC,CACrDC,SAAS,CACPC,QAAQ,IAAI,CACb,CAAC,EACAC,KAAwB,IAAI;QAC3B,IAAIC,YAAY,GAAG,qBAAqB;QACxC,IAAID,KAAK,CAACA,KAAK,IAAIA,KAAK,CAACA,KAAK,CAACE,OAAO,EAAE;UACtCD,YAAY,GAAGD,KAAK,CAACA,KAAK,CAACE,OAAO;;QAEpC,IAAI,CAACpB,YAAY,CAACqB,SAAS,CAAC,OAAO,EAAEF,YAAY,CAAC;MACpD,CAAC,CACF;MACD,IAAI,CAACG,qBAAqB,EAAE;KAE/B,MAAM;MACL,IAAI,CAACtB,YAAY,CAACqB,SAAS,CAAC,OAAO,EAAE,mBAAmB,CAAC;;EAE7D;EAEQC,qBAAqBA,CAAA;IAC3B,IAAI,CAACxB,WAAW,CAACyB,sBAAsB,CAACP,SAAS,CAAEQ,OAAgB,IAAI;MACrE,IAAIA,OAAO,EAAE;QACX,IAAI,CAACxB,YAAY,CAACqB,SAAS,CACzB,SAAS,EACT,UAAU,GAAG,IAAI,CAACnB,SAAS,CAACa,KAAK,CAACX,QAAQ,CAC3C;;IAEL,CAAC,CAAC;EACJ;CAID;AA/DYT,cAAc,GAAA8B,UAAA,EAN1BjC,SAAS,CAAC;EACTkC,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,uBAAuB,CAAC;EACpCC,eAAe,EAAEpC,uBAAuB,CAACqC;CAC1C,CAAC,C,EACWnC,cAAc,CA+D1B;SA/DYA,cAAc;AAoE3B;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA"},"metadata":{},"sourceType":"module","externalDependencies":[]}