{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/auth/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nclass LoginComponent {\n  constructor(_authService, _router, formBuilder) {\n    this._authService = _authService;\n    this._router = _router;\n    this.formBuilder = formBuilder;\n    this.user = {};\n    this.token = '';\n    this.hidePassword = true;\n    this.token = this._authService.getToken();\n    this.loginForm = this.formBuilder.group({\n      email: ['', [Validators.required, Validators.email]],\n      password: ['', Validators.required],\n      rememberMe: [false] // Remember me checkbox\n    });\n  }\n\n  ngOnInit() {\n    const rememberedEmail = localStorage.getItem('rememberedEmail');\n    if (rememberedEmail) {\n      this.loginForm.patchValue({\n        email: rememberedEmail\n      });\n    }\n    if (this.token) {\n      this._router.navigate(['']);\n    }\n    if (this._authService.isLoggedIn()) {\n      this._router.navigate(['']);\n    }\n  }\n  login() {\n    if (this.loginForm.valid) {\n      const {\n        email,\n        password,\n        rememberMe\n      } = this.loginForm.value;\n      const data = {\n        email,\n        password\n      };\n      this._authService.login_admin(data).subscribe(response => {\n        if (!response.data) {\n          this.showErrorToast(response.message || 'There was an error during login');\n        } else {\n          this.handleSuccessfulLogin(response, rememberMe);\n        }\n      }, error => {\n        this.showErrorToast('There was an error during login');\n        console.error(error);\n      });\n    } else {\n      this.showErrorToast('Invalid form data');\n    }\n  }\n  handleSuccessfulLogin(response, remember) {\n    this.user = response.data;\n    localStorage.setItem('token', response.token || '');\n    if (remember) {\n      this.rememberUser(this.loginForm.value.email, true);\n    } else {\n      this.rememberUser('', false);\n    }\n    this._router.navigate(['/']);\n  }\n  rememberUser(email, remember) {\n    if (remember) {\n      localStorage.setItem('rememberedEmail', email);\n    } else {\n      localStorage.removeItem('rememberedEmail');\n    }\n  }\n  showErrorToast(message) {\n    iziToast.show({\n      title: 'ERROR',\n      titleColor: '#FF0000',\n      color: '#FFF',\n      class: 'text-Danger',\n      position: 'topRight',\n      message: message\n    });\n  }\n  togglePasswordVisibility() {\n    this.hidePassword = !this.hidePassword;\n  }\n  get passwordFieldType() {\n    return this.hidePassword ? 'password' : 'text';\n  }\n  static #_ = this.ɵfac = function LoginComponent_Factory(t) {\n    return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LoginComponent,\n    selectors: [[\"app-login\"]],\n    decls: 2,\n    vars: 0,\n    template: function LoginComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"p\");\n        i0.ɵɵtext(1, \"login works!\");\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}\nexport { LoginComponent };","map":{"version":3,"names":["Validators","LoginComponent","constructor","_authService","_router","formBuilder","user","token","hidePassword","getToken","loginForm","group","email","required","password","rememberMe","ngOnInit","rememberedEmail","localStorage","getItem","patchValue","navigate","isLoggedIn","login","valid","value","data","login_admin","subscribe","response","showErrorToast","message","handleSuccessfulLogin","error","console","remember","setItem","rememberUser","removeItem","iziToast","show","title","titleColor","color","class","position","togglePasswordVisibility","passwordFieldType","_","i0","ɵɵdirectiveInject","i1","AuthService","i2","Router","i3","FormBuilder","_2","selectors","decls","vars","template","LoginComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd"],"sources":["C:\\Users\\Javier\\Documents\\proyectos\\e-commerce\\admin\\src\\app\\modules\\auth\\login\\login.component.ts","C:\\Users\\Javier\\Documents\\proyectos\\e-commerce\\admin\\src\\app\\modules\\auth\\login\\login.component.html"],"sourcesContent":["// import { Component } from '@angular/core';\n\n// @Component({\n//   selector: 'app-login',\n//   templateUrl: './login.component.html',\n//   styleUrls: ['./login.component.css']\n// })\n// export class LoginComponent {\n\n// }\n\nimport { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AuthService } from 'src/app/core/auth/auth.service';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\n\ndeclare var iziToast: any;\n\ninterface ApiResponse {\n  data?: any;\n  message?: string;\n  token?: string;\n}\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css'],\n})\nexport class LoginComponent implements OnInit {\n  public user: any = {};\n  public token: any = '';\n  public loginForm: FormGroup;\n\n  constructor(\n    private _authService: AuthService,\n    private _router: Router,\n    private formBuilder: FormBuilder\n  ) {\n    this.token = this._authService.getToken();\n    this.loginForm = this.formBuilder.group({\n      email: ['', [Validators.required, Validators.email]],\n      password: ['', Validators.required],\n      rememberMe: [false], // Remember me checkbox\n    });\n  }\n\n  ngOnInit(): void {\n    const rememberedEmail = localStorage.getItem('rememberedEmail');\n    if (rememberedEmail) {\n      this.loginForm.patchValue({\n        email: rememberedEmail,\n      });\n    }\n\n    if (this.token) {\n      this._router.navigate(['']);\n    }\n    if (this._authService.isLoggedIn()) {\n      this._router.navigate(['']);\n    }\n    \n  }\n\n  login() {\n    if (this.loginForm.valid) {\n      const { email, password, rememberMe } = this.loginForm.value;\n      const data = { email, password };\n      this._authService.login_admin(data).subscribe(\n        (response: ApiResponse) => {\n          if (!response.data) {\n            this.showErrorToast(\n              response.message || 'There was an error during login'\n            );\n          } else {\n            this.handleSuccessfulLogin(response, rememberMe);\n          }\n        },\n        (error) => {\n          this.showErrorToast('There was an error during login');\n          console.error(error);\n        }\n      );\n    } else {\n      this.showErrorToast('Invalid form data');\n    }\n  }\n\n  private handleSuccessfulLogin(response: ApiResponse, remember: boolean) {\n    this.user = response.data;\n    localStorage.setItem('token', response.token || '');\n\n    if (remember) {\n      this.rememberUser(this.loginForm.value.email, true);\n    } else {\n      this.rememberUser('', false);\n    }\n\n    this._router.navigate(['/']);\n  }\n\n  private rememberUser(email: string, remember: boolean) {\n    if (remember) {\n      localStorage.setItem('rememberedEmail', email);\n    } else {\n      localStorage.removeItem('rememberedEmail');\n    }\n  }\n\n  private showErrorToast(message: string) {\n    iziToast.show({\n      title: 'ERROR',\n      titleColor: '#FF0000',\n      color: '#FFF',\n      class: 'text-Danger',\n      position: 'topRight',\n      message: message,\n    });\n  }\n\n  hidePassword: boolean = true;\n  togglePasswordVisibility() {\n    this.hidePassword = !this.hidePassword;\n  }\n\n  get passwordFieldType() {\n    return this.hidePassword ? 'password' : 'text';\n  }\n}\n","<p>login works!</p>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}