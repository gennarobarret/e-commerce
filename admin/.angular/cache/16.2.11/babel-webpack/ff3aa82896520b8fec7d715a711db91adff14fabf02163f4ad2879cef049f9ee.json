{"ast":null,"code":"import { of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"../services/initial-config.service\";\nimport * as i3 from \"@angular/router\";\nclass AdminExistenceAndLoginGuard {\n  constructor(authService, initialConfigService, router) {\n    this.authService = authService;\n    this.initialConfigService = initialConfigService;\n    this.router = router;\n  }\n  canActivate() {\n    return this.initialConfigService.check().pipe(switchMap(adminExists => {\n      if (!adminExists) {\n        // Si no hay administrador, redirige a la página de registro\n        this.router.navigate(['/register']);\n        return of(false);\n      } else {\n        // Si existe un administrador, verifica la autenticación\n        if (this.authService.isAuthenticated(['MasterAdministrator'])) {\n          return of(true);\n        } else {\n          this.router.navigate(['/auth/login']);\n          return of(false);\n        }\n      }\n    }));\n  }\n  static #_ = this.ɵfac = function AdminExistenceAndLoginGuard_Factory(t) {\n    return new (t || AdminExistenceAndLoginGuard)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.InitialConfigService), i0.ɵɵinject(i3.Router));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: AdminExistenceAndLoginGuard,\n    factory: AdminExistenceAndLoginGuard.ɵfac,\n    providedIn: 'root'\n  });\n}\nexport { AdminExistenceAndLoginGuard };","map":{"version":3,"names":["of","switchMap","AdminExistenceAndLoginGuard","constructor","authService","initialConfigService","router","canActivate","check","pipe","adminExists","navigate","isAuthenticated","_","i0","ɵɵinject","i1","AuthService","i2","InitialConfigService","i3","Router","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\Javier\\Documents\\proyectos\\e-commerce\\admin\\src\\app\\core\\guards\\is-logged-in.guard.ts"],"sourcesContent":["//is-logged-in.guard.ts\n\n// import { Injectable } from '@angular/core';\n// import { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, UrlTree, Router } from '@angular/router';\n// import { AuthService } from '../services/auth.service';\n\n// @Injectable({\n//   providedIn: 'root'\n// })\n\n// export class isLoggedInGuard implements CanActivate {\n\n//   constructor(\n//     private authService: AuthService,\n//     private router: Router\n//   ) { }\n\n//   canActivate(\n//     next: ActivatedRouteSnapshot,\n//     state: RouterStateSnapshot): boolean | UrlTree {\n//     // Verifica si el usuario está autenticado o tiene los permisos necesarios para acceder a las rutas del LayoutModule\n//     if (this.authService.isAuthenticated(['MasterAdministrator'])) {\n//       return true;\n//     } else {\n//       // Si el usuario no está autenticado, redirige a la página de inicio de sesión o a la página que desees.\n//       return this.router.createUrlTree(['/auth/login']);\n//     }\n//   }\n// }\n\nimport { Injectable } from '@angular/core';\nimport { CanActivate, Router } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { AuthService } from '../services/auth.service';\nimport { InitialConfigService } from '../services/initial-config.service';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class AdminExistenceAndLoginGuard implements CanActivate {\n  constructor(\n    private authService: AuthService,\n    private initialConfigService: InitialConfigService,\n    private router: Router\n  ) { }\n\n  canActivate(): Observable<boolean> {\n    return this.initialConfigService.check().pipe(\n      switchMap(adminExists => {\n        if (!adminExists) {\n          // Si no hay administrador, redirige a la página de registro\n          this.router.navigate(['/register']);\n          return of(false);\n        } else {\n          // Si existe un administrador, verifica la autenticación\n          if (this.authService.isAuthenticated(['MasterAdministrator'])) {\n            return of(true);\n          } else {\n            this.router.navigate(['/auth/login']);\n            return of(false);\n          }\n        }\n      })\n    );\n  }\n}\n"],"mappings":"AAgCA,SAAqBA,EAAE,QAAQ,MAAM;AACrC,SAASC,SAAS,QAAQ,gBAAgB;;;;;AAI1C,MAGaC,2BAA2B;EACtCC,YACUC,WAAwB,EACxBC,oBAA0C,EAC1CC,MAAc;IAFd,KAAAF,WAAW,GAAXA,WAAW;IACX,KAAAC,oBAAoB,GAApBA,oBAAoB;IACpB,KAAAC,MAAM,GAANA,MAAM;EACZ;EAEJC,WAAWA,CAAA;IACT,OAAO,IAAI,CAACF,oBAAoB,CAACG,KAAK,EAAE,CAACC,IAAI,CAC3CR,SAAS,CAACS,WAAW,IAAG;MACtB,IAAI,CAACA,WAAW,EAAE;QAChB;QACA,IAAI,CAACJ,MAAM,CAACK,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC;QACnC,OAAOX,EAAE,CAAC,KAAK,CAAC;OACjB,MAAM;QACL;QACA,IAAI,IAAI,CAACI,WAAW,CAACQ,eAAe,CAAC,CAAC,qBAAqB,CAAC,CAAC,EAAE;UAC7D,OAAOZ,EAAE,CAAC,IAAI,CAAC;SAChB,MAAM;UACL,IAAI,CAACM,MAAM,CAACK,QAAQ,CAAC,CAAC,aAAa,CAAC,CAAC;UACrC,OAAOX,EAAE,CAAC,KAAK,CAAC;;;IAGtB,CAAC,CAAC,CACH;EACH;EAAC,QAAAa,CAAA,G;qBAzBUX,2BAA2B,EAAAY,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,WAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,oBAAA,GAAAL,EAAA,CAAAC,QAAA,CAAAK,EAAA,CAAAC,MAAA;EAAA;EAAA,QAAAC,EAAA,G;WAA3BpB,2BAA2B;IAAAqB,OAAA,EAA3BrB,2BAA2B,CAAAsB,IAAA;IAAAC,UAAA,EAF1B;EAAM;;SAEPvB,2BAA2B"},"metadata":{},"sourceType":"module","externalDependencies":[]}