{"ast":null,"code":"import { OAuthErrorEvent } from 'angular-oauth2-oidc';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"angular-oauth2-oidc\";\nclass AuthGoogleService {\n  constructor(oauthService) {\n    this.oauthService = oauthService;\n    this.config = {\n      issuer: 'https://accounts.google.com',\n      redirectUri: window.location.origin + '/dashboard',\n      clientId: '386095253324-hu7fnt80k4mqc18p3ob357f215pa2as5.apps.googleusercontent.com',\n      scope: 'openid profile email',\n      strictDiscoveryDocumentValidation: false\n    };\n    this.initLogin();\n  }\n  initLogin() {\n    this.oauthService.configure(this.config);\n    this.oauthService.setupAutomaticSilentRefresh();\n    // Carga el documento de descubrimiento y trata de iniciar sesiÃ³n automÃ¡ticamente\n    this.oauthService.loadDiscoveryDocumentAndTryLogin().then(() => {\n      if (!this.oauthService.hasValidAccessToken()) {\n        // Opcional: Redirigir al usuario al login si no tiene un token vÃ¡lido\n        // this.login();\n      }\n    });\n    // Manejador de eventos de error\n    this.oauthService.events.subscribe(event => {\n      if (event instanceof OAuthErrorEvent) {\n        console.error('OAuthErrorEvent Object:', event);\n      } else {\n        console.log('OAuthEvent', event);\n      }\n    });\n  }\n  login() {\n    this.oauthService.initLoginFlow();\n  }\n  logout() {\n    this.oauthService.logOut();\n  }\n  getProfile() {\n    if (this.isAuthenticated()) {\n      const claims = this.oauthService.getIdentityClaims();\n      console.log(\"ðŸš€ ~ AuthGoogleService ~ getProfile ~ claims:\", claims);\n      if (!claims) {\n        console.log('No se pudo obtener los claims del perfil del usuario.');\n        return null;\n      }\n      return {\n        nombre: claims.name,\n        email: claims.email,\n        imagen: claims.picture\n      };\n    } else {\n      console.log('Usuario no autenticado.');\n      return null;\n    }\n  }\n  isAuthenticated() {\n    return this.oauthService.hasValidAccessToken();\n  }\n  static #_ = this.Éµfac = function AuthGoogleService_Factory(t) {\n    return new (t || AuthGoogleService)(i0.ÉµÉµinject(i1.OAuthService));\n  };\n  static #_2 = this.Éµprov = /*@__PURE__*/i0.ÉµÉµdefineInjectable({\n    token: AuthGoogleService,\n    factory: AuthGoogleService.Éµfac,\n    providedIn: 'root'\n  });\n}\nexport { AuthGoogleService };","map":{"version":3,"names":["OAuthErrorEvent","AuthGoogleService","constructor","oauthService","config","issuer","redirectUri","window","location","origin","clientId","scope","strictDiscoveryDocumentValidation","initLogin","configure","setupAutomaticSilentRefresh","loadDiscoveryDocumentAndTryLogin","then","hasValidAccessToken","events","subscribe","event","console","error","log","login","initLoginFlow","logout","logOut","getProfile","isAuthenticated","claims","getIdentityClaims","nombre","name","email","imagen","picture","_","i0","ÉµÉµinject","i1","OAuthService","_2","factory","Éµfac","providedIn"],"sources":["C:\\Users\\Javier\\Documents\\proyectos\\e-commerce\\admin\\src\\app\\core\\services\\auth-google.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { AuthConfig, OAuthService, OAuthErrorEvent } from 'angular-oauth2-oidc';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class AuthGoogleService {\r\n  private config: AuthConfig = {\r\n    issuer: 'https://accounts.google.com',\r\n    redirectUri: window.location.origin + '/dashboard',\r\n    clientId:\r\n      '386095253324-hu7fnt80k4mqc18p3ob357f215pa2as5.apps.googleusercontent.com',\r\n    scope: 'openid profile email',\r\n    strictDiscoveryDocumentValidation: false\r\n  };\r\n\r\n  constructor(private oauthService: OAuthService) {\r\n    this.initLogin();\r\n  }\r\n\r\n  initLogin() {\r\n    this.oauthService.configure(this.config);\r\n    this.oauthService.setupAutomaticSilentRefresh();\r\n\r\n    // Carga el documento de descubrimiento y trata de iniciar sesiÃ³n automÃ¡ticamente\r\n    this.oauthService.loadDiscoveryDocumentAndTryLogin().then(() => {\r\n      if (!this.oauthService.hasValidAccessToken()) {\r\n        // Opcional: Redirigir al usuario al login si no tiene un token vÃ¡lido\r\n        // this.login();\r\n      }\r\n    });\r\n\r\n    // Manejador de eventos de error\r\n    this.oauthService.events.subscribe(event => {\r\n      if (event instanceof OAuthErrorEvent) {\r\n        console.error('OAuthErrorEvent Object:', event);\r\n      } else {\r\n        console.log('OAuthEvent', event);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  login() {\r\n    this.oauthService.initLoginFlow();\r\n  }\r\n\r\n  logout() {\r\n    this.oauthService.logOut();\r\n  }\r\n\r\n  getProfile() {\r\n    if (this.isAuthenticated()) {\r\n      const claims: any = this.oauthService.getIdentityClaims();\r\n      console.log(\"ðŸš€ ~ AuthGoogleService ~ getProfile ~ claims:\", claims)\r\n      if (!claims) {\r\n        console.log('No se pudo obtener los claims del perfil del usuario.');\r\n        return null;\r\n      }\r\n      return {\r\n        nombre: claims.name,\r\n        email: claims.email,\r\n        imagen: claims.picture,\r\n      };\r\n    } else {\r\n      console.log('Usuario no autenticado.');\r\n      return null;\r\n    }\r\n  }\r\n\r\n  isAuthenticated(): boolean {\r\n    return this.oauthService.hasValidAccessToken();\r\n  }\r\n\r\n}\r\n"],"mappings":"AACA,SAAmCA,eAAe,QAAQ,qBAAqB;;;AAE/E,MAGaC,iBAAiB;EAU5BC,YAAoBC,YAA0B;IAA1B,KAAAA,YAAY,GAAZA,YAAY;IATxB,KAAAC,MAAM,GAAe;MAC3BC,MAAM,EAAE,6BAA6B;MACrCC,WAAW,EAAEC,MAAM,CAACC,QAAQ,CAACC,MAAM,GAAG,YAAY;MAClDC,QAAQ,EACN,0EAA0E;MAC5EC,KAAK,EAAE,sBAAsB;MAC7BC,iCAAiC,EAAE;KACpC;IAGC,IAAI,CAACC,SAAS,EAAE;EAClB;EAEAA,SAASA,CAAA;IACP,IAAI,CAACV,YAAY,CAACW,SAAS,CAAC,IAAI,CAACV,MAAM,CAAC;IACxC,IAAI,CAACD,YAAY,CAACY,2BAA2B,EAAE;IAE/C;IACA,IAAI,CAACZ,YAAY,CAACa,gCAAgC,EAAE,CAACC,IAAI,CAAC,MAAK;MAC7D,IAAI,CAAC,IAAI,CAACd,YAAY,CAACe,mBAAmB,EAAE,EAAE;QAC5C;QACA;MAAA;IAEJ,CAAC,CAAC;IAEF;IACA,IAAI,CAACf,YAAY,CAACgB,MAAM,CAACC,SAAS,CAACC,KAAK,IAAG;MACzC,IAAIA,KAAK,YAAYrB,eAAe,EAAE;QACpCsB,OAAO,CAACC,KAAK,CAAC,yBAAyB,EAAEF,KAAK,CAAC;OAChD,MAAM;QACLC,OAAO,CAACE,GAAG,CAAC,YAAY,EAAEH,KAAK,CAAC;;IAEpC,CAAC,CAAC;EACJ;EAGAI,KAAKA,CAAA;IACH,IAAI,CAACtB,YAAY,CAACuB,aAAa,EAAE;EACnC;EAEAC,MAAMA,CAAA;IACJ,IAAI,CAACxB,YAAY,CAACyB,MAAM,EAAE;EAC5B;EAEAC,UAAUA,CAAA;IACR,IAAI,IAAI,CAACC,eAAe,EAAE,EAAE;MAC1B,MAAMC,MAAM,GAAQ,IAAI,CAAC5B,YAAY,CAAC6B,iBAAiB,EAAE;MACzDV,OAAO,CAACE,GAAG,CAAC,+CAA+C,EAAEO,MAAM,CAAC;MACpE,IAAI,CAACA,MAAM,EAAE;QACXT,OAAO,CAACE,GAAG,CAAC,uDAAuD,CAAC;QACpE,OAAO,IAAI;;MAEb,OAAO;QACLS,MAAM,EAAEF,MAAM,CAACG,IAAI;QACnBC,KAAK,EAAEJ,MAAM,CAACI,KAAK;QACnBC,MAAM,EAAEL,MAAM,CAACM;OAChB;KACF,MAAM;MACLf,OAAO,CAACE,GAAG,CAAC,yBAAyB,CAAC;MACtC,OAAO,IAAI;;EAEf;EAEAM,eAAeA,CAAA;IACb,OAAO,IAAI,CAAC3B,YAAY,CAACe,mBAAmB,EAAE;EAChD;EAAC,QAAAoB,CAAA,G;qBAlEUrC,iBAAiB,EAAAsC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,YAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAjB1C,iBAAiB;IAAA2C,OAAA,EAAjB3C,iBAAiB,CAAA4C,IAAA;IAAAC,UAAA,EAFhB;EAAM;;SAEP7C,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}